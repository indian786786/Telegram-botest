<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>SSC Practice MCQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      background: #0b1533;
      color: white;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h1 { text-align: center; }

    input, button {
      width: 100%;
      padding: 14px;
      margin-top: 10px;
      font-size: 16px;
      border-radius: 6px;
      border: none;
    }

    button { cursor: pointer; }

    .option {
      border: 1px solid #444;
      padding: 12px;
      margin-top: 10px;
      border-radius: 6px;
      cursor: pointer;
    }

    .correct { background: #1e7f3b; }
    .wrong { background: #8b1e1e; }

    #explanation {
      margin-top: 15px;
      padding: 12px;
      background: #111;
      border-left: 4px solid #00c3ff;
    }
  </style>
</head>

<body>
  <h1>SSC Practice MCQ</h1>

  <input id="topic" placeholder="Enter topic (e.g. Lodi dynasty)">
  <button onclick="startQuiz()">Start</button>
  <button onclick="nextQuestion()">Skip / Next</button>

  <div id="quiz"></div>
  <div id="explanation"></div>

<script>
let questions = [];
let index = 0;
let locked = false;

async function startQuiz() {
  const topic = document.getElementById("topic").value.trim();
  if (!topic) return alert("Enter a topic");

  document.getElementById("quiz").innerHTML = "Loading questions...";
  document.getElementById("explanation").innerHTML = "";

  const res = await fetch("/api", {
    method: "POST",
    body: JSON.stringify({ topic })
  });

  questions = await res.json();
  index = 0;
  showQuestion();
}

function showQuestion() {
  locked = false;
  const q = questions[index];
  let html = `<h3>Q${index + 1}. ${q.question}</h3>`;

  q.options.forEach((opt, i) => {
    html += `<div class="option" onclick="checkAnswer(this, ${i})">${opt}</div>`;
  });

  document.getElementById("quiz").innerHTML = html;
  document.getElementById("explanation").innerHTML = "";
}

function checkAnswer(div, i) {
  if (locked) return;
  locked = true;

  const q = questions[index];
  const options = document.querySelectorAll(".option");

  if (i === q.answer) {
    div.classList.add("correct");
  } else {
    div.classList.add("wrong");
    options[q.answer].classList.add("correct");
  }

  document.getElementById("explanation").innerHTML =
    `<b>Explanation:</b> ${q.explanation}`;
}

function nextQuestion() {
  if (!questions.length) return;
  index = (index + 1) % questions.length;
  showQuestion();
}
</script>
</body>
</html>      options: [
        "History",
        "Physics",
        "Biology",
        "Economics"
      ],
      answer: 0,
      explain: `${topic} belongs to History and is commonly covered under General Studies for SSC.`
    },
    {
      q: `Why is ${topic} important for competitive exams?`,
      options: [
        "Concept clarity",
        "Entertainment",
        "No importance",
        "Only for research"
      ],
      answer: 0,
      explain: `Questions from ${topic} test basic conceptual understanding required for SSC exams.`
    },
    {
      q: `${topic} questions are usually asked in which section?`,
      options: [
        "General Awareness",
        "Quantitative Aptitude",
        "Reasoning",
        "English"
      ],
      answer: 0,
      explain: `${topic} appears under the General Awareness section in SSC exams.`
    },
    {
      q: `What type of questions are asked from ${topic}?`,
      options: [
        "Objective MCQs",
        "Long essays",
        "Coding",
        "Practical exams"
      ],
      answer: 0,
      explain: `SSC exams ask objective multiple-choice questions from ${topic}.`
    }
  ];

  showQuestion();
}

function showQuestion() {
  answered = false;
  const quiz = document.getElementById("quiz");
  const explanation = document.getElementById("explanation");
  explanation.style.display = "none";
  quiz.innerHTML = "";

  if (!questions[index]) {
    quiz.innerHTML = "<b>Quiz completed âœ”</b>";
    return;
  }

  const q = questions[index];

  const qDiv = document.createElement("div");
  qDiv.innerHTML = "<b>Q" + (index + 1) + ". " + q.q + "</b>";
  quiz.appendChild(qDiv);

  q.options.forEach((opt, i) => {
    const div = document.createElement("div");
    div.className = "option";
    div.innerText = opt;
    div.onclick = () => checkAnswer(div, i);
    quiz.appendChild(div);
  });
}

function checkAnswer(div, i) {
  if (answered) return;
  answered = true;

  const q = questions[index];
  const options = document.querySelectorAll(".option");

  options.forEach(o => o.onclick = null);

  if (i === q.answer) {
    div.classList.add("correct");
  } else {
    div.classList.add("wrong");
    options[q.answer].classList.add("correct");
  }

  const explanation = document.getElementById("explanation");
  explanation.innerHTML = "<b>Explanation:</b><br>" + q.explain;
  explanation.style.display = "block";
}

function nextQuestion() {
  index++;
  showQuestion();
}
</script>

</body>
</html>
